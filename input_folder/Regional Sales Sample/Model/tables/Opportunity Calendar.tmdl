table 'Opportunity Calendar'

	column Date
		formatString: Short Date
		summarizeBy: none
		isNameInferred
		sourceColumn: [Date]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="DateTimeGeneralPattern"><DateTimes><DateTime LCID="1033" Group="ShortDate" FormatString="M/d/yyyy" /></DateTimes></Format>

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_ChangedProperties = ["DataType"]

	column DAY
		isHidden
		formatString: Short Date
		summarizeBy: none
		isNameInferred
		sourceColumn: [DAY]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="DateTimeGeneralPattern"><DateTimes><DateTime LCID="1033" Group="ShortDate" FormatString="M/d/yyyy" /></DateTimes></Format>

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_ChangedProperties = ["DataType"]

	column DaySeq
		isHidden
		formatString: 0
		summarizeBy: none
		isNameInferred
		sourceColumn: [DaySeq]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="NumberWhole" Accuracy="0" />

	column YEAR
		formatString: 0
		summarizeBy: none
		isNameInferred
		sourceColumn: [YEAR]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="NumberWhole" Accuracy="0" />

	column 'MONTH NUMBER'
		isHidden
		formatString: 0
		summarizeBy: none
		isNameInferred
		sourceColumn: [MONTH NUMBER]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="NumberWhole" Accuracy="0" />

	column MONTH
		summarizeBy: none
		isNameInferred
		sourceColumn: [MONTH]
		sortByColumn: 'MONTH NUMBER'

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="Text" />

	column 'YEAR MONTH NUMBER'
		isHidden
		formatString: 0
		summarizeBy: none
		isNameInferred
		sourceColumn: [YEAR MONTH NUMBER]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="NumberWhole" Accuracy="0" />

	column 'YEAR MONTH'
		summarizeBy: none
		isNameInferred
		sourceColumn: [YEAR MONTH]
		sortByColumn: 'YEAR MONTH NUMBER'

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="Text" />

	column 'YEAR WEEK'
		summarizeBy: none
		isNameInferred
		sourceColumn: [YEAR WEEK]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="Text" />

	column WEEK
		formatString: General Date
		summarizeBy: none
		isNameInferred
		sourceColumn: [WEEK]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="DateTimeGeneralPattern"><DateTimes><DateTime LCID="1033" Group="GeneralDateTimeLong" FormatString="G" /></DateTimes></Format>

	column 'RELATIVE WEEK'
		summarizeBy: none
		isNameInferred
		sourceColumn: [RELATIVE WEEK]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="General" />

	column 'RELATIVE DAY'
		formatString: General Date
		summarizeBy: none
		isNameInferred
		sourceColumn: [RELATIVE DAY]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="DateTimeGeneralPattern"><DateTimes><DateTime LCID="1033" Group="GeneralDateTimeLong" FormatString="G" /></DateTimes></Format>

	column 'RELATIVE 07 DAY PERIOD'
		summarizeBy: none
		isNameInferred
		sourceColumn: [RELATIVE 07 DAY PERIOD]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="General" />

	column 'RELATIVE 30 DAY PERIOD'
		summarizeBy: none
		isNameInferred
		sourceColumn: [RELATIVE 30 DAY PERIOD]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="General" />

	column 'RELATIVE MONTH'
		formatString: 0
		summarizeBy: none
		isNameInferred
		sourceColumn: [RELATIVE MONTH]

		annotation SummarizationSetBy = Automatic

		annotation Format = <Format Format="NumberWhole" Accuracy="0" />

	partition 'Opportunity Calendar-e59f2a98-a17b-43c5-9430-3661e3b638f8' = calculated
		mode: import
		source = ```
				
				VAR StartDate =
				    DATE ( YEAR ( MIN ( Opportunities[CloseDate] ) ), 1, 1 )
				VAR EndDate =
				    DATE ( YEAR (
				        IF (
				            ISBLANK ( MAX (  Opportunities[CloseDate] ) ),
				            TODAY (),
				            MAX (  Opportunities[CloseDate] )
				        )
				    ), 12, 31 )
				VAR BASECALENDAR =
				    CALENDAR ( StartDate, EndDate )
				RETURN
				    GENERATE (
				        BASECALENDAR,
				        VAR DateSequence = DATEDIFF ( StartDate, [DATE], DAY ) + 1
				        VAR BASEDATE = [DATE]
				        VAR YEARDATE = YEAR ( BASEDATE )
				        VAR MONTHNUMBER = MONTH ( BASEDATE )
				        VAR MONTHNAME = FORMAT ( BASEDATE, "MMMM" )
				        VAR YEARMONTHNAME = FORMAT ( BASEDATE, "MMM YYYY" )
				        VAR YEARMONTHNUMBER = YEARDATE * 12 + ( MONTHNUMBER - 1 )
				        VAR YEARWEEK = YEARDATE & "-W" & RIGHT ( "0" & WEEKNUM ( BASEDATE ), 2 )
				        VAR DayNumberOfWeek = WEEKDAY ( [Date] )
				        VAR StartOfWeek = [Date] - ( 1 * DayNumberOfWeek )
				        VAR StartOfRelativeWeek = [Date] - WEEKDAY ( [Date] ) + 1
				        VAR StartOfCurrentWeek = TODAY () - WEEKDAY ( TODAY () ) + 1
				        var RelativeMonth = DATEDIFF(TODAY(),[Date],MONTH)
				        VAR RelativeWeek = ( StartOfRelativeWeek - StartOfCurrentWeek ) / 7
				        var RelativeDay = BASEDATE - TODAY()
				        var Relative7DayPeriod = ROUNDDOWN(([Date] - TODAY())/7,0) + IF([Date]<TODAY(),+1,+2)
				        var Relative30DayPeriod = ROUNDDOWN(([Date] - TODAY())/30,0) + IF([Date]>TODAY(),1,0)   
				
				        RETURN
				            ROW (
				                "DAY", BASEDATE,
				                "DaySeq", DateSequence,
				                "YEAR", YEARDATE,
				                "MONTH NUMBER", MONTHNUMBER,
				                "MONTH", MONTHNAME,
				                "YEAR MONTH NUMBER", YEARMONTHNUMBER,
				                "YEAR MONTH", YEARMONTHNAME,
				                "YEAR WEEK", YEARWEEK,
				                "WEEK", StartOfWeek,
				                "RELATIVE MONTH", RelativeMonth,
				                "RELATIVE WEEK", RelativeWeek,
				                "RELATIVE DAY", RelativeDay,
				                "RELATIVE 07 DAY PERIOD", Relative7DayPeriod,
				                "RELATIVE 30 DAY PERIOD", Relative30DayPeriod
				                )
				            )
				```

